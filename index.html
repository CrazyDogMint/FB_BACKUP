<!DOCTYPE HTML>
<html ng-app="myApp" ng-controller="main">
<head>
	<meta charset="utf-8">
	<title ng-bind="ret.info.name">Backup Facebook</title>
	<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.min.js"></script>
	<script src="js/controller.js"></script>
	<link rel="stylesheet" href="styles/style.css">
</head>
<body>
	<div ng-include="'templates/body_header.html'"
		onload="node=ret.info; tabs=ret.tabs;"
	></div>
	<nav ng-if="true" title="debug">
		<ul>
			<li ng-repeat="t in ret.templates">
				<a target="_blank" href="templates/{{t}}.html">{{t}}</a>
			</li>
		</ul>
	</nav>
	<section id="info" ng-if="ret.tab=='info'">
		<h2>Info</h2>
		<img ng-src="{{ret.info.picture.data.url}}" onerror="this.style.display='none';">
		<dl>
			<dt>ID</dt><dd>{{ret.info.id}}</dd>
			<dt>Engagement</dt><dd>{{ret.info.engagement.count|number}}</dd>
			<dt>Category</dt><dd>{{ret.info.category}}</dd>
			<dt>Website</dt><dd><a href="{{ret.info.website}}">{{ret.info.website}}</a></dd>
			<dt>Personal Interests</dt><dd>{{ret.info.personal_interests}}</dd>
		</dl>
		<details class="rawdata"><summary>JSON</summary>{{ret.info|json}}</details>
	</section>
	<section ng-repeat="t in ret.tabs" ng-show="t==ret.tab" id="{{t}}">
		<h2>{{t|capitalize}}</h2>
		<div ng-if="t=='feed'||t=='posts'||t=='comments'">
			<label>
				Search:
				<input ng-model="ret.search[t]"
					ng-model-options="{debounce: 250}" placeholder="search text"
				>
			</label>
			<p ng-show="ret.search[t]">matched {{filtered.length}} {{t}}</p>
			<nav ng-hide="ret.search[t]">
				<ul>
					<li ng-repeat="m in ret.months[t]"
						ng-click="ret.month[t] = m"
						ng-class="(ret.month[t] == m)?'focus':''"
					>{{m}}</li>
				</ul>
			</nav>
		</div>
		<article ng-if="t=='posts'||t=='feed'||t=='comments'"
			ng-repeat="node in filtered=(ret[t]|filter:(ret.search[t]?ret.search[t]:{created_time:ret.month[t]}))"
			ng-include="'templates/post_body.html'"
		></article>
		
		<article ng-if="t=='albums'" ng-repeat="node in ret[t]" ng-include="'templates/album_body.html'"
		></article>
		<article ng-if="t=='photos'" ng-repeat="node in ret[t]" ng-include="'templates/photo_body.html'"
		></article>
		<!--article ng-repeat="node in ret[t]">
			<details class="rawdata"><summary>JSON</summary>{{node|json}}</details>
		</article-->
	</section>
</body>
</html>
